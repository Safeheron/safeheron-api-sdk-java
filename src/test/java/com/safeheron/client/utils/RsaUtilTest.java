package com.safeheron.client.utils;

import org.junit.Assert;
import org.junit.Test;

import java.nio.charset.StandardCharsets;

/**
 * @author safeheron
 * @date 2022/7/25 17:04
 */
public class RsaUtilTest {

    private String PUBLIC_KEY = "MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAqUW5Z2eRk6ErtB9iA+rphbM3krRJNRPLD8H72dDkLlQxmkr7anYRJ/2HpPK5U5Uy8LSfVTHFIQgWDgREtBlrxHfkZ+A8t8OTzATJ0Snm8/7lBsN+KAA/6Y/9e/pJXvxPgBLFdqH4xjCAFNrvwkm1bXmquGAoxsXu0B61gs0cgSEjVQfeKRn6/4fvl3FxQp4I2HHlxEWWxv9F39Ph0rg6xNM2GXiQiQCIDu7jhq9dZzYDmA5D8L/pGiXVzjoupTQo+agsCQOrvbOHABXA37FWwoVtI0x6N+166LwAjxPSeJDhh+DOCzH2ASwB0Cwj9+tBR7Qg7Es35crNsMis8/C7N9GRnsdxAw5dCZQNbcyNmU8RnkpyyFL8kMAT6fwW+i5i73ZDxpDPqYmP258pD6daVYd+lUqy4NqKfqgeKqfu9lGrASbLj9RPFF3rqrFgcA2w30lJkD8d/InINBqW65EjLxYjLCeBykchbXLbyk/4FIksc076EO0GuqZ4kKpK1PWZzI9udy769recRqh4M7ZYfkan12od3hBDfbsAky0qCZSnNu0wof8dHSYhq8ffMxAgUfugKGhgOYsZKenut07UBKWdwF5CpowbCSmypy1vCQKJcsmACnAEvLp3gD1N3OPDiZ2UKxuEwUDGDmkjjXILGBVTCnDWgryfnYxcc/p0cfcCAwEAAQ==";
    private String PRIVATE_KEY = "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";

    @Test
    public void encrypt() throws Exception {
        String encryptData = RsaUtil.encrypt("plaintext".getBytes(StandardCharsets.UTF_8), PUBLIC_KEY);
        System.out.println(encryptData);
    }

    @Test
    public void decrypt() throws Exception {
        byte[] decryptedData = RsaUtil.decrypt("moQ7WHKGHkVIFpZT5PRXKN3uafZgMju/p27jteKURz2UA2xW1mLyOHVV04EBLPw6+FdXofXX9als/+B4PQhPWMkWqY+JVLtCv2WxVYdQGl0GNO9NarXVev9iIrelTLJqN6N/jlg10BHOt6aDYEd1wCBK73pjEzZjiFE/S3+19OGGGZv5uctRT7QP5wGSnGVhNRldx0xhdboLaAp+cPDa53qI/nJnRFSUHckjLcwWDNsS+s8KB3Dwcnhf6yfUOOz2G4gxxD1lw4eejWeSIZrt7YoM0bpO0a4KNCF6tanHOeHecmxdp0QESmPVYw6VlwU27N3mYVu1R55YGU5PP/D7pOyLAeRs3KYUQchC6S8GIwgqpCSd5bhm0A5jgsiIjOoyd6KQQkBeGM32HFT1Kplfds42iuSHoHWjEQhEdBAkgBDtBA7L39t4hEx7pmjLmBWX9i88CE93M3m8qnF6y3pJReEwYtSy/hU0JT4UtDpbBNBYIrx1v/5IWtyp8etxCM49DycsE9+N93iDRw1+8KDW0byS+fIUMmcnpG4Ypc75COgFjGAM5o7/lfucReRZJAp5VDUczxDLu0GX7BseGMwLr8o6VzQeXZMN8FZYpL4OTiEtlcE/xBTw6IWkMrHETei2qi60cjbUg5XtL0GG1omp8qgGa++xZ+LzmXCG56z3RtM=", PRIVATE_KEY);
        Assert.assertEquals("plaintext", new String(decryptedData));
    }

    @Test
    public void sign() throws Exception {
        String signature = RsaUtil.sign("sign text", PRIVATE_KEY);
        System.out.println(signature);
    }

    @Test
    public void verifySign() throws Exception {
        String content = "sign text";
        String signature = "loASTm2mUTE3bXcn54pQNuKfBeOn4pJtI5yvykLIjZoxhFSfVtxes5Tb5Tl1FMTUCxmESrO/JQGPOekEJnvf5d8o6uOHwfJPfTCVJHHEu5CjJmDjBO55hoQQg/sMSrAVugvf0W9gXZXLu7q5slqCVAx9awIM146gKZkQ/NPu9J6TDGlw9M+iyGjsDB7E3NgHcIdVnWavQpHEjur6bBXaqtA7bzlDD3dq1fdqZqnODaX4LuUrpE0W/Fw22pxVLynXUHCdZNELXMkCZdO87Z8tsuIK1+dfGGla4oKMjTVIvXd3pbGmAhWgkcIQ7YlVPnCAX5heaWNu4Njz6WlD1xqu1kGAOKXP+eGjBSsCt8vJJnRoYnEHksnOf8nftbb59jgGvI4Edmm+udv/Mqp0hPioInlrlAWKxRDdg9s1SlggO5xk8LdY0rZlusKbAg0DrqtIK4AOXR84zcNEK30eA6nfYvyVOlolIUna2TwtvZZChZW2nr0QrQ/ykplxP+rOLc19T0KIy2OLPsvk/FGg1nh4XMCJ7tHXCA2717u8rqsGREx1mDSZZiroFaQ1be/5t9MtmSiN3Eps14+vMbS7qzGpQkzsR6DyRu0PKaloqsttP0woixkyWZeSwbrLtfZ5RibVWLk0AHmuU4WPAKRPELnYV0CF/YW/xDOJjLrM+3mll6M=";
        Assert.assertTrue(RsaUtil.verifySign(content, signature, PUBLIC_KEY));
    }
}